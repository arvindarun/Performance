# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml
trigger:
  - main

parameters:
  - name: thread
    displayName: THREADS
    # default: 10
    type: string
  
  - name: rampUP
    displayName: RAMP_UP
    # default: 10
    type: string
  
  - name: loopCount
    displayName: LOOP_COUNT
    # default: 10
    type: string
    
steps:
- task: Maven@4
  inputs:
    mavenPomFile: 'pom.xml'
    goals: 'clean test -Dthreads=${{parameters.thread}} -DrampUP=${{parameters.rampUP}} -DloopCount=${{parameters.loopCount}} verify'
    publishJUnitResults: false
    javaHomeOption: 'JDKVersion'
    mavenVersionOption: 'Default'
    mavenAuthenticateFeed: false
    effectivePomSkip: false
    sonarQubeRunAnalysis: false
  continueOnError: true
  condition: always()

- task: PublishBuildArtifacts@1
  inputs:
      PathtoPublish: 'target/jmeter/results'
      ArtifactName: 'Reports'
      publishLocation: 'Container'